Implement comprehensive user tracking and analytics features for the admin dashboard, including both authenticated and anonymous visitor tracking.
Database Schema Requirements (Prisma)
1. Update User Model
Add lastAccessedAt field to track when users last accessed the application
Add any necessary relations for tracking
2. Create PageView Model
Track all page visits (both authenticated and anonymous users)
Fields needed:
Unique session ID
User ID (nullable for anonymous visitors)
IP address (hashed for privacy)
User agent
Page URL/path
Referrer
Timestamp
Session duration
3. Create Analytics/Statistics Model (optional)
Store aggregated daily/hourly statistics for performance
Fields: date, unique visitors, total page views, etc.
Backend Implementation Requirements
1. Middleware/Function to Track Page Access
Update lastAccessedAt for authenticated users on each request
Create/update PageView records for all visitors
Generate unique session IDs for anonymous users (using cookies/fingerprinting)
Hash IP addresses for privacy compliance
2. API Endpoints
GET /api/admin/users - List all users with last access time
GET /api/admin/analytics/visitors - Get visitor statistics (unique visitors, page views, etc.)
GET /api/admin/analytics/activity - Get user activity data for charts
GET /api/admin/users/:id/activity - Get specific user's activity history
3. Analytics Functions
getUniqueVisitors(timeRange) - Count unique visitors in time period
getPageViewStats(timeRange) - Get page view statistics
getUserActivityStats() - Get authenticated user activity
getTopPages() - Most visited pages
Frontend Implementation Requirements
1. Admin Dashboard Updates
Add statistics cards showing:
Total users
Active users (last 24h/7d/30d)
Total unique visitors
Page views today/this week/this month
2. New User Management Tab
Table displaying:
User name/email
Registration date
Last accessed date/time
Total page views
Status (active/inactive based on last access)
Sorting and filtering capabilities
Search functionality
3. Analytics Charts
Visitor Timeline Chart: Line chart showing unique visitors vs page views over time
User Activity Heatmap: Show when users are most active
Top Pages Chart: Bar chart of most visited pages
User vs Anonymous Traffic: Pie chart comparing authenticated vs anonymous visitors
Geographic Distribution: Map or chart showing visitor locations (if tracking)


