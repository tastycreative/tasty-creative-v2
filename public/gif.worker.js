!function t(e,i,r){function s(n,a){if(!i[n]){if(!e[n]){var h="function"==typeof require&&require;if(!a&&h)return h(n,!0);if(o)return o(n,!0);var l=Error("Cannot find module '"+n+"'");throw l.code="MODULE_NOT_FOUND",l}var u=i[n]={exports:{}};e[n][0].call(u.exports,function(t){return s(e[n][1][t]||t)},u,u.exports,t,e,i,r)}return i[n].exports}for(var o="function"==typeof require&&require,n=0;n<r.length;n++)s(r[n]);return s}({1:[function(t,e,i){var r=t("./TypedNeuQuant.js"),s=t("./LZWEncoder.js");function o(){this.page=-1,this.pages=[],this.newPage()}o.pageSize=4096,o.charMap={};for(var n=0;n<256;n++)o.charMap[n]=String.fromCharCode(n);function a(t,e){this.width=~~t,this.height=~~e,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=[],this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new o}o.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(o.pageSize),this.cursor=0},o.prototype.getData=function(){for(var t="",e=0;e<this.pages.length;e++)for(var i=0;i<o.pageSize;i++)t+=o.charMap[this.pages[e][i]];return t},o.prototype.writeByte=function(t){this.cursor>=o.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=t},o.prototype.writeUTFBytes=function(t){for(var e=t.length,i=0;i<e;i++)this.writeByte(t.charCodeAt(i))},o.prototype.writeBytes=function(t,e,i){for(var r=i||t.length,s=e||0;s<r;s++)this.writeByte(t[s])},a.prototype.setDelay=function(t){this.delay=Math.round(t/10)},a.prototype.setFrameRate=function(t){this.delay=Math.round(100/t)},a.prototype.setDispose=function(t){t>=0&&(this.dispose=t)},a.prototype.setRepeat=function(t){this.repeat=t},a.prototype.setTransparent=function(t){this.transparent=t},a.prototype.addFrame=function(t){this.image=t,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),!0===this.globalPalette&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),this.firstFrame||this.globalPalette||this.writePalette(),this.writePixels(),this.firstFrame=!1},a.prototype.finish=function(){this.out.writeByte(59)},a.prototype.setQuality=function(t){t<1&&(t=1),this.sample=t},a.prototype.setDither=function(t){!0===t&&(t="FloydSteinberg"),this.dither=t},a.prototype.setGlobalPalette=function(t){this.globalPalette=t},a.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette},a.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")},a.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new r(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),null!==this.dither.match(/-serpentine/)):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,null!==this.transparent&&(this.transIndex=this.findClosest(this.transparent,!0))},a.prototype.indexPixels=function(t){var e=this.pixels.length/3;this.indexedPixels=new Uint8Array(e);for(var i=0,r=0;r<e;r++){var s=this.findClosestRGB(255&this.pixels[i++],255&this.pixels[i++],255&this.pixels[i++]);this.usedEntry[s]=!0,this.indexedPixels[r]=s}},a.prototype.ditherPixels=function(t,e){var i={FalseFloydSteinberg:[[3/8,1,0],[3/8,0,1],[2/8,1,1]],FloydSteinberg:[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]],Stucki:[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]],Atkinson:[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]]};if(!t||!i[t])throw"Unknown dithering kernel: "+t;var r=i[t],s=0,o=this.height,n=this.width,a=this.pixels,h=e?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var l=0;l<o;l++){e&&(h*=-1);for(var u=1==h?0:n-1,p=1==h?n:0;u!==p;u+=h){var f=3*(s=l*n+u),c=a[f],y=a[f+1],w=a[f+2];f=this.findClosestRGB(c,y,w),this.usedEntry[f]=!0,this.indexedPixels[s]=f,f*=3;for(var d=this.colorTab[f],g=this.colorTab[f+1],x=this.colorTab[f+2],b=c-d,v=y-g,P=w-x,m=1==h?0:r.length-1,B=1==h?r.length:0;m!==B;m+=h){var S=r[m][1],T=r[m][2];if(S+u>=0&&S+u<n&&T+l>=0&&T+l<o){var F=r[m][0];a[f=(s+S+T*n)*3]=Math.max(0,Math.min(255,a[f]+b*F)),a[f+1]=Math.max(0,Math.min(255,a[f+1]+v*F)),a[f+2]=Math.max(0,Math.min(255,a[f+2]+P*F))}}}}},a.prototype.findClosest=function(t,e){return this.findClosestRGB((0xff0000&t)>>16,(65280&t)>>8,255&t,e)},a.prototype.findClosestRGB=function(t,e,i,r){if(null===this.colorTab)return -1;if(this.neuQuant&&!r)return this.neuQuant.lookupRGB(t,e,i);for(var s=0,o=0x1000000,n=this.colorTab.length,a=0,h=0;a<n;h++){var l=t-(255&this.colorTab[a++]),u=e-(255&this.colorTab[a++]),p=i-(255&this.colorTab[a++]),f=l*l+u*u+p*p;(!r||this.usedEntry[h])&&f<o&&(o=f,s=h)}return s},a.prototype.getImagePixels=function(){var t=this.width,e=this.height;this.pixels=new Uint8Array(t*e*3);for(var i=this.image,r=0,s=0,o=0;o<e;o++)for(var n=0;n<t;n++)this.pixels[s++]=i[r++],this.pixels[s++]=i[r++],this.pixels[s++]=i[r++],r++},a.prototype.writeGraphicCtrlExt=function(){var t,e;this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4),null===this.transparent?(t=0,e=0):(t=1,e=2),this.dispose>=0&&(e=7&dispose),e<<=2,this.out.writeByte(e|t),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)},a.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)},a.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)},a.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)},a.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var t=768-this.colorTab.length,e=0;e<t;e++)this.out.writeByte(0)},a.prototype.writeShort=function(t){this.out.writeByte(255&t),this.out.writeByte(t>>8&255)},a.prototype.writePixels=function(){new s(this.width,this.height,this.indexedPixels,this.colorDepth).encode(this.out)},a.prototype.stream=function(){return this.out},e.exports=a},{"./LZWEncoder.js":2,"./TypedNeuQuant.js":3}],2:[function(t,e,i){var r=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];e.exports=function(t,e,i,s){var o,n,a,h,l,u,p=Math.max(2,s),f=new Uint8Array(256),c=new Int32Array(5003),y=new Int32Array(5003),w=0,d=0,g=!1;function x(t,e){f[o++]=t,o>=254&&v(e)}function b(t){for(var e=0;e<t;++e)c[e]=-1}function v(t){o>0&&(t.writeByte(o),t.writeBytes(f,0,o),o=0)}function P(){return 0===remaining?-1:(--remaining,255&i[curPixel++])}function m(t,e){for(u&=r[w],w>0?u|=t<<w:u=t,w+=n_bits;w>=8;)x(255&u,e),u>>=8,w-=8;if((d>n||g)&&(g?(n=(1<<(n_bits=a))-1,g=!1):n=12==++n_bits?4096:(1<<n_bits)-1),t==l){for(;w>0;)x(255&u,e),u>>=8,w-=8;v(e)}}this.encode=function(i){i.writeByte(p),remaining=t*e,curPixel=0,function(t,e){var i,r,s,u,p,f;for(i=5003,g=!1,n=(1<<(n_bits=a=t))-1,l=(h=1<<t-1)+1,d=h+2,o=0,u=P(),f=0;i<65536;i*=2)++f;f=8-f,b(5003),m(h,e);t:for(;-1!=(r=P());){if(i=(r<<12)+u,c[s=r<<f^u]===i){u=y[s];continue}if(c[s]>=0){p=5003-s,0===s&&(p=1);do if((s-=p)<0&&(s+=5003),c[s]===i){u=y[s];continue t}while(c[s]>=0)}(m(u,e),u=r,d<4096)?(y[s]=d++,c[s]=i):(b(5003),d=h+2,g=!0,m(h,e))}m(u,e),m(l,e)}(p+1,i),i.writeByte(0)}}},{}],3:[function(t,e,i){var r=64,s=65536;e.exports=function(t,e){var i,o,n,a,h;this.buildColormap=function(){var l,u;for(l=0,i=[],o=new Int32Array(256),n=new Int32Array(256),a=new Int32Array(256),h=new Int32Array(32);l<256;l++)u=(l<<12)/256,i[l]=new Float64Array([u,u,u,0]),a[l]=256,n[l]=0;!function(){var o,l,u,p,f,c,y,w,d=t.length,g=30+(e-1)/3,x=d/(3*e),b=~~(x/100),v=1024,P=2048,m=32;for(u=0;u<m;u++)h[u]=(m*m-u*u)*256/(m*m)*v;d<1509?(e=1,p=3):p=d%499!=0?1497:d%491!=0?1473:d%487!=0?1461:1509;var B=0;for(u=0;u<x;)if(f=(255&t[B])<<4,w=function(t,e,o){var h,l,u,p,f,c=0x7fffffff,y=0x7fffffff,w=-1,d=-1;for(h=0;h<256;h++)(u=Math.abs((l=i[h])[0]-t)+Math.abs(l[1]-e)+Math.abs(l[2]-o))<c&&(c=u,w=h),(p=u-(n[h]>>12))<y&&(y=p,d=h),f=a[h]>>10,a[h]-=f,n[h]+=f<<10;return a[w]+=r,n[w]-=s,d}(f,c=(255&t[B+1])<<4,y=(255&t[B+2])<<4),o=v,l=w,i[l][0]-=o*(i[l][0]-f)/1024,i[l][1]-=o*(i[l][1]-c)/1024,i[l][2]-=o*(i[l][2]-y)/1024,0!==m&&function(t,e,r,s,o){for(var n,a,l=Math.abs(e-t),u=Math.min(e+t,256),p=e+1,f=e-1,c=1;p<u||f>l;)a=h[c++],p<u&&(n=i[p++],n[0]-=a*(n[0]-r)/262144,n[1]-=a*(n[1]-s)/262144,n[2]-=a*(n[2]-o)/262144),f>l&&(n=i[f--],n[0]-=a*(n[0]-r)/262144,n[1]-=a*(n[1]-s)/262144,n[2]-=a*(n[2]-o)/262144)}(m,w,f,c,y),(B+=p)>=d&&(B-=d),0===b&&(b=1),++u%b==0)for(v-=v/g,P-=P/30,m=P>>6,m<=1&&(m=0),w=0;w<m;w++)h[w]=(m*m-w*w)*256/(m*m)*v}();for(var p=0;p<256;p++)i[p][0]>>=4,i[p][1]>>=4,i[p][2]>>=4,i[p][3]=p;!function(){var t,e,r,s,n,a,h=0,l=0;for(t=0;t<256;t++){for(r=i[t],n=t,a=r[1],e=t+1;e<256;e++)(s=i[e])[1]<a&&(n=e,a=s[1]);if(s=i[n],t!=n&&(e=s[0],s[0]=r[0],r[0]=e,e=s[1],s[1]=r[1],r[1]=e,e=s[2],s[2]=r[2],r[2]=e,e=s[3],s[3]=r[3],r[3]=e),a!=h){for(o[h]=l+t>>1,e=h+1;e<a;e++)o[e]=t;h=a,l=t}}for(o[h]=l+255>>1,e=h+1;e<256;e++)o[e]=255}()},this.getColormap=function(){for(var t=[],e=[],r=0;r<256;r++)e[i[r][3]]=r;for(var s=0,o=0;o<256;o++){var n=e[o];t[s++]=i[n][0],t[s++]=i[n][1],t[s++]=i[n][2]}return t},this.lookupRGB=function(t,e,r){for(var s,n,a,h=1e3,l=-1,u=o[e],p=u-1;u<256||p>=0;)u<256&&((a=(n=i[u])[1]-e)>=h?u=256:(u++,a<0&&(a=-a),(s=n[0]-t)<0&&(s=-s),(a+=s)<h&&((s=n[2]-r)<0&&(s=-s),(a+=s)<h&&(h=a,l=n[3])))),p>=0&&((a=e-(n=i[p])[1])>=h?p=-1:(p--,a<0&&(a=-a),(s=n[0]-t)<0&&(s=-s),(a+=s)<h&&((s=n[2]-r)<0&&(s=-s),(a+=s)<h&&(h=a,l=n[3]))));return l}}},{}],4:[function(t,e,i){var r,s;r=t("./GIFEncoder.js"),s=function(t){var e,i,s,o;return(e=new r(t.width,t.height),0===t.index?e.writeHeader():e.firstFrame=!1,e.setTransparent(t.transparent),e.setRepeat(t.repeat),e.setDelay(t.delay),e.setQuality(t.quality),e.setDither(t.dither),e.setGlobalPalette(t.globalPalette),e.addFrame(t.data),t.last&&e.finish(),!0===t.globalPalette&&(t.globalPalette=e.getGlobalPalette()),t.data=(s=e.stream()).pages,t.cursor=s.cursor,t.pageSize=s.constructor.pageSize,t.canTransfer)?(o=function(){var e,r,s,o;for(e=0,s=t.data,o=[],r=s.length;e<r;e++)i=s[e],o.push(i.buffer);return o}(),self.postMessage(t,o)):self.postMessage(t)},self.onmessage=function(t){return s(t.data)}},{"./GIFEncoder.js":1}]},{},[4]);